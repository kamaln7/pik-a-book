<div ng-controller="EbooksController">
	<h2>Browse Latest E-books</h2>
	<div ng-show="error" class="alert alert-danger">{{error}}</div>
	<!-- -how to add book content -->
	<!-- <iframe src="./books/A-Apple-Pie,-by-Kate-Greenaway/book.html" seamless></iframe> -->
	<div>
		<h4 ng-show="!ebooks">Loading e-books..</h4>
		<div ng-repeat="book in ebooks" class="row">
			<div class="col-sm-1"></div>
			<div class="col-sm-10">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">{{ book.name }}</h3>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-sm-8">
								<p class="text-justify">{{ book.description }}</p>
							</div>
							<div class="col-sm-4 text-right">
								<img src="./books/{{ book.path }}/files/cover.jpg" class="img-rounded book-cover-small" alt="book cover">
							</div>
						</div>

						<button class="btn font-weight-bold btn-warning" type="button">${{ book.price }}</button>
						<div class="dropdown inline-block">
							<div class="btn-group">
								<button type="button" class="btn" ng-class="{'btn-primary' : state.authed}"><span>{{ state.authed ? (userHasLiked(book.likes, state.user_id) ? 'Dislike' : 'Like') : 'Likes' }}</span></button>
								<button class="btn dropdown-toggle" type="button" id="dropdown{{ book.id }}" data-toggle="dropdown" ng-class="{'btn-primary' : state.authed}">
									<span class="badge">{{ book.likes.length }}</span>
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu">
									<li ng-repeat="like in book.likes" ng-class="{ 'active': state.user_id == like.user_id }">
										<a href="#">{{ like.user_nickname }}</a>
									</li>
								</ul>
							</div>
						</div>
						<button type="button" class="btn btn-info" data-toggle="collapse" data-target="#reviews{{ book.id }}">
							Reviews
							<span class="badge">{{ book.reviews.length }}</span>
						</button>
						<div id="reviews{{ book.id }}" class="collapse">
							<hr>
							<h3>Reviews</h3>
							<div ng-repeat="review in book.reviews">
								<div class="media">
									<div class="media-left">
										<img class="media-object user-icon" src="{{ review.user_photo || './user_icon.png' }}">
									</div>
									<div class="media-body">
										<h4 class="media-heading">{{ review.user_nickname }}</h4>
										<p class="text-justify">{{ review.content }}</p>
									</div>
								</div>
								<br ng-show="!last">
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-sm-1"></div>
		</div>
	</div>
</div>
